<html>
<head>
<title>Нафтометро
</title>
</head>
<body bgcolor=#FFFFFF text=#000000>
<center><h1>Описание стандартов</h1></center>

<center><h2>Naftomap</h2></center>
<div align=left>
В файле с расширением "naftomap" храниться карта уровня (компьютерная модель метрополитена).<br><br>
Шапка, в которой указываться всякие общие сведения.<br>
<b>amount=100500</b> - количество точек пути<br>
<b>idtrain=1050</b> - id точки пути, на которой изначально стоит голова поезда<br>
<b>scb=ololo.naftoscb</b> - указание на файл, откуда надо грузить расположение светофоров<br>
<b>stations=bugoga.naftostations</b> - указание на файл, откуда надо грузить инструкции для станций<br>
В принципе, допускаются комментарии, расположенные на отдельной строке и начинающиеся с символа <b>#</b><br>
<b>!</b> - символ, означающий конец шапки<br>
После окончания шапки идут точки. Можно оставлять пустые строки, а комментарии ставить только в конце строки.<br>
Каждая точка пути характеризуется набором чисел:<br>
<b>id x y z n1 n2 p1 p2 t idstat bool</b><br>
<b>id</b> - идентификатор точки пути, целое чилсло<br>
<b>x y z</b> - координаты точки пути, вещественные числа<br>
<b>n1 n2</b> (next1 next2) - идентефикаторы следующих точек пути (левой и правой), целые числа<br>
<b>p1 p2</b> (previous1 previous2) - аналогично предыдущие точки пути<br>
<b>t</b> (together) - с какой точкой нужно эту рисовать вместе<br>
<b>idstat</b> (id station) - идентификатор станции, к которой относится точка пути<br><b>bool</b> - целое неотрицательное число, хранит всякие логические свойства точки пути<br>
Если точка пути находиться на левой ветви камеры съезда, то в bool младший бит нужно ставить в 1
</div><br>

<center><h2>Naftoscb</h2></center>
<div align=left>
В файлах с этим расширением храниться структура светофоров.<br><br>
Шапка, в которой указываться всякие общие сведения.<br>
<b>amountscb=100500</b> - количество светофоров<br>
<b>!</b> - символ, означающий конец шапки<br>
Каждый светофор характеризуется набором чисел:<br>
<b>idtp cond n1 n2 bool table1 table2</b><br>
<b>idtp</b> - идентификатор точки пути, на которую повешен светофор<br>
<b>cond</b> (condition) - состояние светофора (см. светофорный кодекс)<br>
<b>n1 n2</b> (next1 next2) - идентефикаторы следующих светофоров, по первому и второму пути<br>
<b>bool</b> - целое неотрицательное число, хранит всякие логические свойства сваетофора<br>
Если светофор установлен "железно" (всегда имеет одно и то же показание), то в bool младший бит нужно ставить в 1<br>
Если светофор действует вдоль возрастания пикетажа, то в bool 2-ой с конца бит нужно ставить в 1<br>
Если светофор повешен в тоннеле на правой, а не на левой стенке, то в bool 3-ий с конца бит нужно ставить в 1 (ещё не сделано)<br>
<b>table1 table2</b> - таблицы зависимостей показания светофора от показаний следующего за ним светофора (по первому пути - table1, по второму - table2)<br>
20 чисел (в диапащоне 0-19). Актуально для "нежелезных" светофоров. На данный момент используется около 13 первых показаний<br>
</div><br>

<center><h2>Naftostations</h2></center>
<div align=left>
В файлах с этим расширением хранятся инструкции по размещению станций.<br><br>
Шапка, в которой указываться всякие общие сведения.<br>
<b>amountstat=100500</b> - количество светофоров<br>
<b>!</b> - символ, означающий конец шапки<br>
Каждая станция характеризуется набором чисел:<br>
<b>id x y z alpha</b><br>
<b>id</b> - идентификатор станции<br>
<b>x y z</b> - координаты в мире игры, куда надо поставить точку отсчёта координат модели<br>
<b>alpha</b> - угол поворота модели станции, в радианах. Возрастает против часовой стрелки, 0 - на восток.<br>
Скорее всего в ближайшее время стандарт будет активно развиваться!<br>
</div><br>

<center><h2>Models (модели)</h2></center>
<div align=left>
В файлах 1.txt - n.txt хранятся 3d модели станций в следующем виде:<br><br>
<b>npoints</b> - количество точек в модели. Автоматически задаются их id в диапозоне [0, npoints-1]<br>
<b>id x y z</b> - идентификатор и координаты точки 3d модели. Id бутафорский - для удобство редактирования, НЕ влияет на настоящий id<br>
Можно разделять точки пустыми строками. Главное - количество точек должно совпадать с заявленным!<br>
<b>nquads</b> - количество четырёхугольников, из которых состоит 3d модель<br>
<b>idtex</b> 4x(<b>idpoint xtex ytex</b>) - так хранятся четырёхугольники, образующие 3d объект<br>
idtex - идентификатор текстуры, которую надо натягивать на данный четырёхугольник<br>
idpoint - идентификатор точки, за которую крепится данный четырёхугольник<br>
xtex ytex - координаты точки внутри плоскости текстуры. Пока что целые числа (возможно развитие до вещественных)<br>
Можно разделять четырёхугольники пустыми строками. Главное - количество четырёхугольников должно совпадать с заявленным!<br>
</div><br>

<center><h2>cab.txt (кабина)</h2></center>
<div align=left>
В данном файле хранится 3d модель кабины поезда. Структура схожа с файлами 3d мое=делей станций.<br><br>
<b>npoints</b> - количество точек в модели. Автоматически задаются их id в диапозоне [0, npoints-1]<br>
<b>x y z bool</b> - координаты точки 3d модели и логическая переменная. Если bool = 1, то в эту точку помещается глаз машиниста.<br>
Можно разделять точки пустыми строками. Главное - количество точек должно совпадать с заявленным!<br>
<b>nquads</b> - количество четырёхугольников, из которых состоит 3d модель<br>
<b>idtex</b> 4x(<b>idpoint xtex ytex</b>) - так хранятся четырёхугольники, образующие 3d объект<br>
idtex - идентификатор текстуры, которую надо натягивать на данный четырёхугольник<br>
idpoint - идентификатор точки, за которую крепится данный четырёхугольник<br>
xtex ytex - координаты точки внутри плоскости текстуры. Пока что целые числа (возможно развитие до вещественных)<br>
Можно разделять четырёхугольники пустыми строками. Главное - количество четырёхугольников должно совпадать с заявленным!<br>
</div><br>

<center><h2>params.naftometro (параметры)</h2></center>
<div align=left>
В данном файле хранится общие глобальные параметры игры. На даный момент это:<br><br>
<b>nwag=2</b> - количество вагонов в составе поезда<br>
<b>wlength=19</b> - длина вагонов в метрах (пока, увы, целое число)<br>
<b>pwidth=4,16</b> - ширина габарита поезда<br>
<b>pheight=4,4</b> - высота габарита поезда<br>
<b>map=test.naftomap</b> - указание, какую карту метрополитена надо играть<br>
В будущем список параметров может быть увеличен.<br>
</div><br>

</body>
</html>